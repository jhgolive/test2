<button id="btn">뉴스 시작</button>
<div id="news"></div>

<script>
const newsEl = document.getElementById("news");
const btn = document.getElementById("btn");
const API_URL = "https://proxy-production-b9d6.up.railway.app/news";

btn.addEventListener("click", async () => {
  btn.remove();
  
  // 1. 버튼 클릭 즉시 첫 뉴스 음성 재생
  const firstNews = "뉴스 스크롤 테스트입니다.";
  const msg = new SpeechSynthesisUtterance(firstNews);
  msg.lang = "ko-KR";
  window.speechSynthesis.speak(msg);

  // 2. 화면에 바로 표시 + 스크롤
  newsEl.textContent = firstNews;
  newsEl.style.transition = "transform 10s linear";
  newsEl.style.transform = "translateX(-100%)";

  // 3. 동시에 서버에서 실제 뉴스 가져오기
  try {
    const res = await fetch(API_URL);
    const data = await res.json();
    if (data.news) {
      setTimeout(() => {
        newsEl.textContent = data.news;
        newsEl.style.transition = "none";
        newsEl.style.transform = "translateX(100vw)";
        setTimeout(() => {
          newsEl.style.transition = "transform 10s linear";
          newsEl.style.transform = "translateX(-100%)";
        }, 50);
      }, 10000); // 첫 뉴스 스크롤 끝난 후 새 뉴스 적용
    }
  } catch (err) {
    console.error(err);
  }
});
</script>
